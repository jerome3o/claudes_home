version: '3.8'

services:
  webtop:
    image: webtop-mcp
    container_name: webtop
    privileged: true
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
      - TITLE=Claude Desktop
      # Fixed resolution settings
      - SELKIES_MANUAL_WIDTH=1920
      - SELKIES_MANUAL_HEIGHT=1080
      # Lock DPI to 96 (prevents client devicePixelRatio from scaling UI)
      - SELKIES_SCALING_DPI=96
      # Enable Docker in Docker
      - START_DOCKER=true
    network_mode: host
    volumes:
      # Persistent browser data (Firefox profile)
      - webtop-config:/config
      # Shared folder for file exchange between host and container
      - ./shared:/shared
      # Persistent downloads folder
      - ./downloads:/config/Downloads
    # ports not needed with network_mode: host (3000 HTTP, 3001 HTTPS)
    restart: unless-stopped
    shm_size: "2gb"  # Increased shared memory for browser performance

volumes:
  webtop-config:
    name: webtop-config
